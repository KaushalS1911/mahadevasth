import{cc as P,cd as A,r as j,ce as D,j as e,al as q,i as t,aA as $,T as f,_ as c,S as n,aa as S,ck as C,ag as L,D as M,bT as B,aj as X,az as K,B as T,ac as Z,I as J,h as u,c as I,f0 as je,fo as be,a0 as fe,ds as _,fp as Q,a_ as z,aF as ye,fq as ve,fr as we,cx as G,cb as F,dj as ke,L as Ce,bi as Ie,bf as Te,e_ as Se,co as Me,O,a as Le,b as Ee,aK as Ne,p as w,C as Re,n as Fe,H as Ue}from"./index-fhA8hu8c.js";import{k as ze,f as Pe}from"./keyBy-CVodnQFT.js";import{T as Ae}from"./text-max-line-MpR8MLLa.js";import"./_baseEach-gYolQBDu.js";function De(){const s=D.mail.labels,{data:r,isLoading:o,error:l,isValidating:i}=P(s,A);return j.useMemo(()=>({labels:(r==null?void 0:r.labels)||[],labelsLoading:o,labelsError:l,labelsValidating:i,labelsEmpty:!o&&!(r!=null&&r.labels.length)}),[r==null?void 0:r.labels,l,o,i])}function $e(s){const r=s?[D.mail.list,{params:{labelId:s}}]:"",{data:o,isLoading:l,error:i,isValidating:x}=P(r,A);return j.useMemo(()=>{const p=ze(o==null?void 0:o.mails,"id")||{},m=Object.keys(p)||[];return{mails:{byId:p,allIds:m},mailsLoading:l,mailsError:i,mailsValidating:x,mailsEmpty:!l&&!m.length}},[o==null?void 0:o.mails,i,l,x])}function Be(s){const r=s?[D.mail.details,{params:{mailId:s}}]:"",{data:o,isLoading:l,error:i,isValidating:x}=P(r,A);return j.useMemo(()=>({mail:o==null?void 0:o.mail,mailLoading:l,mailError:i,mailValidating:x}),[o==null?void 0:o.mail,i,l,x])}const Ve={all:"fluent:mail-24-filled",inbox:"solar:inbox-bold",trash:"solar:trash-bin-trash-bold",drafts:"solar:file-text-bold",spam:"solar:danger-bold",sent:"iconamoon:send-fill",starred:"eva:star-fill",important:"material-symbols:label-important-rounded",social:"solar:tag-horizontal-bold-duotone",promotions:"solar:tag-horizontal-bold-duotone",forums:"solar:tag-horizontal-bold-duotone"};function Y({selected:s,label:r,onClickNavItem:o,...l}){const{unreadCount:i,color:x,name:a}=r,p=Ve[r.id];return e.jsxs(q,{disableRipple:!0,onClick:o,sx:{px:0,height:40,color:"text.secondary",...s&&{color:"text.primary"},"&:hover":{bgcolor:"transparent"}},...l,children:[e.jsx(t,{icon:p,width:22,sx:{mr:2,color:x}}),e.jsx($,{primary:a,primaryTypographyProps:{textTransform:"capitalize",typography:s?"subtitle2":"body2"}}),!!i&&e.jsx(f,{variant:"caption",children:i})]})}Y.propTypes={selected:c.bool,label:c.object,onClickNavItem:c.func};function ee({sx:s,...r}){return e.jsxs(n,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,color:o=>S(o.palette.grey[500],.24),...s},...r,children:[e.jsx(C,{variant:"circular",sx:{width:32,height:32,bgcolor:"currentColor"}}),e.jsx(C,{sx:{width:.5,height:10,bgcolor:"currentColor"}})]})}ee.propTypes={sx:c.object};function se({sx:s,...r}){return e.jsxs(n,{spacing:2,direction:"row",alignItems:"center",sx:{py:1,...s},...r,children:[e.jsx(C,{variant:"circular",sx:{width:40,height:40}}),e.jsxs(n,{spacing:1,flexGrow:1,children:[e.jsx(C,{sx:{width:.75,height:10}}),e.jsx(C,{sx:{width:.5,height:10}})]})]})}se.propTypes={sx:c.object};function oe({loading:s,openNav:r,onCloseNav:o,labels:l,selectedLabelId:i,handleClickLabel:x,onToggleCompose:a}){const p=L("up","md"),m=e.jsx(e.Fragment,{children:[...Array(8)].map((d,y)=>e.jsx(ee,{},y))}),h=e.jsx(e.Fragment,{children:l.map(d=>e.jsx(Y,{label:d,selected:i===d.id,onClickNavItem:()=>{x(d.id)}},d.id))}),g=e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{p:d=>({xs:d.spacing(2.5,2.5,2,2.5),md:d.spacing(2,1.5)})},children:e.jsx(M,{fullWidth:!0,color:"inherit",variant:"contained",startIcon:e.jsx(t,{icon:"solar:pen-bold"}),onClick:a,children:"Compose"})}),e.jsx(B,{children:e.jsxs(n,{sx:{px:{xs:3.5,md:2.5}},children:[s&&m,!!l.length&&h]})})]});return p?e.jsx(n,{sx:{width:200,flexShrink:0},children:g}):e.jsx(X,{open:r,onClose:o,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:260}},children:g})}oe.propTypes={handleClickLabel:c.func,labels:c.array,loading:c.bool,onCloseNav:c.func,onToggleCompose:c.func,openNav:c.bool,selectedLabelId:c.string};function re({mail:s,selected:r,sx:o,...l}){return e.jsxs(q,{sx:{p:1,mb:.5,borderRadius:1,...r&&{bgcolor:"action.selected"},...o},...l,children:[e.jsx(K,{alt:s.from.name,src:s.from.avatarUrl?`${s.from.avatarUrl}`:"",sx:{mr:2},children:s.from.name.charAt(0).toUpperCase()}),e.jsxs(e.Fragment,{children:[e.jsx($,{primary:s.from.name,primaryTypographyProps:{noWrap:!0,variant:"subtitle2"},secondary:s.message,secondaryTypographyProps:{noWrap:!0,component:"span",variant:s.isUnread?"subtitle2":"body2",color:s.isUnread?"text.primary":"text.secondary"}}),e.jsxs(n,{alignItems:"flex-end",sx:{ml:2,height:44},children:[e.jsx(f,{noWrap:!0,variant:"body2",component:"span",sx:{mb:1.5,fontSize:12,color:"text.disabled"},children:Pe(new Date(s.createdAt),{addSuffix:!1})}),!!s.isUnread&&e.jsx(T,{sx:{bgcolor:"info.main",width:8,height:8,borderRadius:"50%"}})]})]})]})}re.propTypes={mail:c.object,selected:c.bool,sx:c.object};function ne({loading:s,mails:r,openMail:o,onCloseMail:l,onClickMail:i,selectedLabelId:x,selectedMailId:a}){const p=L("up","md"),m=e.jsx(e.Fragment,{children:[...Array(8)].map((d,y)=>e.jsx(se,{},y))}),h=e.jsx(e.Fragment,{children:r.allIds.map(d=>e.jsx(re,{mail:r.byId[d],selected:a===d,onClick:()=>{i(d)}},d))}),g=e.jsxs(e.Fragment,{children:[e.jsx(n,{sx:{p:2},children:p?e.jsx(Z,{placeholder:"Search...",InputProps:{startAdornment:e.jsx(J,{position:"start",children:e.jsx(t,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}}):e.jsx(f,{variant:"h6",sx:{textTransform:"capitalize"},children:x})}),e.jsxs(B,{sx:{px:2},children:[s&&m,!!r.allIds.length&&h]})]});return p?e.jsx(n,{sx:{width:320,flexShrink:0,borderRadius:1.5,bgcolor:"background.default"},children:g}):e.jsx(X,{open:o,onClose:l,slotProps:{backdrop:{invisible:!0}},PaperProps:{sx:{width:320}},children:g})}ne.propTypes={loading:c.bool,mails:c.object,onClickMail:c.func,onCloseMail:c.func,openMail:c.bool,selectedLabelId:c.string,selectedMailId:c.string};function ie({onOpenNav:s,onOpenMail:r,...o}){return e.jsxs(n,{spacing:2,direction:"row",alignItems:"center",sx:{py:1},...o,children:[e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsx(u,{onClick:s,children:e.jsx(t,{icon:"fluent:mail-24-filled"})}),r&&e.jsx(u,{onClick:r,children:e.jsx(t,{icon:"solar:chat-round-dots-bold"})})]}),e.jsx(Z,{fullWidth:!0,size:"small",placeholder:"Search...",InputProps:{startAdornment:e.jsx(J,{position:"start",children:e.jsx(t,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})]})}ie.propTypes={onOpenMail:c.func,onOpenNav:c.func};const H=1998,k=24;function ae({onCloseCompose:s}){const r=L("up","sm"),[o,l]=j.useState(""),i=I(),x=j.useCallback(a=>{l(a)},[]);return e.jsxs(je,{children:[(i.value||!r)&&e.jsx(be,{open:!0,sx:{zIndex:H}}),e.jsxs(fe,{sx:{right:0,bottom:0,borderRadius:2,display:"flex",position:"fixed",zIndex:H+1,m:`${k}px`,overflow:"hidden",flexDirection:"column",boxShadow:a=>a.customShadows.dropdown,...i.value&&{m:0,right:k/2,bottom:k/2,width:`calc(100% - ${k}px)`,height:`calc(100% - ${k}px)`}},children:[e.jsxs(n,{direction:"row",alignItems:"center",sx:{bgcolor:"background.neutral",p:a=>a.spacing(1.5,1,1.5,2)},children:[e.jsx(f,{variant:"h6",sx:{flexGrow:1},children:"New Message"}),e.jsx(u,{onClick:i.onToggle,children:e.jsx(t,{icon:i?"eva:collapse-fill":"eva:expand-fill"})}),e.jsx(u,{onClick:s,children:e.jsx(t,{icon:"mingcute:close-line"})})]}),e.jsx(_,{placeholder:"To",endAdornment:e.jsxs(n,{direction:"row",spacing:.5,sx:{typography:"subtitle2"},children:[e.jsx(T,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Cc"}),e.jsx(T,{sx:{cursor:"pointer","&:hover":{textDecoration:"underline"}},children:"Bcc"})]}),sx:{px:2,height:48,borderBottom:a=>`solid 1px ${S(a.palette.grey[500],.08)}`}}),e.jsx(_,{placeholder:"Subject",sx:{px:2,height:48,borderBottom:a=>`solid 1px ${S(a.palette.grey[500],.08)}`}}),e.jsxs(n,{spacing:2,flexGrow:1,sx:{p:2},children:[e.jsx(Q,{simple:!0,id:"compose-mail",value:o,onChange:x,placeholder:"Type a message",sx:{"& .ql-editor":{},...i.value&&{height:1,"& .quill":{height:1},"& .ql-editor":{maxHeight:"unset"}}}}),e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsxs(n,{direction:"row",alignItems:"center",flexGrow:1,children:[e.jsx(u,{children:e.jsx(t,{icon:"solar:gallery-add-bold"})}),e.jsx(u,{children:e.jsx(t,{icon:"eva:attach-2-fill"})})]}),e.jsx(M,{variant:"contained",color:"primary",endIcon:e.jsx(t,{icon:"iconamoon:send-fill"}),children:"Send"})]})]})]})]})}ae.propTypes={onCloseCompose:c.string};function te({mail:s,renderLabel:r}){const o=I(!0);if(!s)return e.jsx(z,{title:"No Conversation Selected",description:"Select a conversation to read",imgUrl:"/assets/icons/empty/ic_email_selected.svg",sx:{borderRadius:1.5,bgcolor:"background.default"}});const l=e.jsxs(n,{direction:"row",alignItems:"center",flexShrink:0,sx:{height:56,pl:2,pr:1},children:[e.jsx(n,{direction:"row",spacing:1,flexGrow:1,children:s.labelIds.map(h=>{const g=r(h);return g?e.jsx(ye,{sx:{bgcolor:S(g.color,.16),color:d=>d.palette.mode==="light"?ve(g.color,.24):we(g.color,.24)},children:g.name},g.id):null})}),e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsx(G,{color:"warning",icon:e.jsx(t,{icon:"eva:star-outline"}),checkedIcon:e.jsx(t,{icon:"eva:star-fill"}),checked:s.isStarred}),e.jsx(G,{color:"warning",icon:e.jsx(t,{icon:"material-symbols:label-important-rounded"}),checkedIcon:e.jsx(t,{icon:"material-symbols:label-important-rounded"}),checked:s.isImportant}),e.jsx(F,{title:"Archive",children:e.jsx(u,{children:e.jsx(t,{icon:"solar:archive-down-minimlistic-bold"})})}),e.jsx(F,{title:"Mark Unread",children:e.jsx(u,{children:e.jsx(t,{icon:"fluent:mail-unread-20-filled"})})}),e.jsx(F,{title:"Trash",children:e.jsx(u,{children:e.jsx(t,{icon:"solar:trash-bin-trash-bold"})})}),e.jsx(u,{children:e.jsx(t,{icon:"eva:more-vertical-fill"})})]})]}),i=e.jsxs(n,{spacing:2,direction:"row",flexShrink:0,sx:{p:2},children:[e.jsxs(Ae,{variant:"subtitle2",sx:{flexGrow:1},children:["Re: ",s.subject]}),e.jsxs(n,{spacing:.5,children:[e.jsxs(n,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(u,{size:"small",children:e.jsx(t,{width:18,icon:"solar:reply-bold"})}),e.jsx(u,{size:"small",children:e.jsx(t,{width:18,icon:"solar:multiple-forward-left-broken"})}),e.jsx(u,{size:"small",children:e.jsx(t,{width:18,icon:"solar:forward-bold"})})]}),e.jsx(f,{variant:"caption",noWrap:!0,sx:{color:"text.disabled"},children:ke(s.createdAt)})]})]}),x=e.jsxs(n,{flexShrink:0,direction:"row",alignItems:"center",sx:{p:h=>h.spacing(2,2,1,2)},children:[e.jsx(K,{alt:s.from.name,src:s.from.avatarUrl?`${s.from.avatarUrl}`:"",sx:{mr:2},children:s.from.name.charAt(0).toUpperCase()}),e.jsx($,{primary:e.jsxs(e.Fragment,{children:[s.from.name,e.jsx(T,{component:"span",sx:{typography:"body2",color:"text.disabled"},children:` <${s.from.email}>`})]}),secondary:e.jsxs(e.Fragment,{children:["To: ",s.to.map(h=>e.jsx(Ce,{sx:{color:"text.secondary"},children:`${h.email}, `},h.email))]}),secondaryTypographyProps:{mt:.5,noWrap:!0,component:"span",typography:"caption"}})]}),a=e.jsxs(n,{spacing:1,sx:{p:1,borderRadius:1,bgcolor:"background.neutral"},children:[e.jsxs(n,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(Ie,{onClick:o.onToggle,sx:{color:"text.secondary",typography:"caption",borderRadius:.5},children:[e.jsx(t,{icon:"eva:attach-2-fill",sx:{mr:.5}}),s.attachments.length," attachments",e.jsx(t,{icon:o.value?"eva:arrow-ios-upward-fill":"eva:arrow-ios-downward-fill",width:16,sx:{ml:.5}})]}),e.jsx(M,{startIcon:e.jsx(t,{icon:"eva:cloud-download-fill"}),children:"Download"})]}),e.jsx(Te,{in:o.value,unmountOnExit:!0,timeout:"auto",children:e.jsx(n,{direction:"row",flexWrap:"wrap",spacing:1,children:s.attachments.map(h=>e.jsx(n,{alignItems:"center",justifyContent:"center",sx:{width:40,height:40,flexShrink:0,borderRadius:1,overflow:"hidden",position:"relative",backgroundColor:"background.neutral"},children:e.jsx(Se,{tooltip:!0,imageView:!0,file:h.preview,onDownload:()=>console.info("DOWNLOAD"),sx:{width:24,height:24}})},h.id))})})]}),p=e.jsx(T,{sx:{py:3,flexGrow:1,overflow:{xs:"auto",md:"hidden"}},children:e.jsx(B,{children:e.jsx(Me,{children:s.message,sx:{px:2,"& p":{typography:"body2"}}})})}),m=e.jsxs(n,{spacing:2,sx:{p:h=>h.spacing(0,2,2,2)},children:[e.jsx(Q,{simple:!0,id:"reply-mail"}),e.jsxs(n,{direction:"row",alignItems:"center",children:[e.jsxs(n,{direction:"row",alignItems:"center",flexGrow:1,children:[e.jsx(u,{children:e.jsx(t,{icon:"solar:gallery-add-bold"})}),e.jsx(u,{children:e.jsx(t,{icon:"eva:attach-2-fill"})})]}),e.jsx(M,{variant:"contained",color:"primary",endIcon:e.jsx(t,{icon:"iconamoon:send-fill"}),children:"Send"})]})]});return e.jsxs(n,{flexGrow:1,sx:{width:1,minWidth:0,borderRadius:1.5,bgcolor:"background.default"},children:[l,e.jsx(O,{sx:{borderStyle:"dashed"}}),i,e.jsx(O,{sx:{borderStyle:"dashed"}}),x,!!s.attachments.length&&e.jsxs(n,{sx:{px:2},children:[" ",a," "]}),p,m]})}te.propTypes={mail:c.object,renderLabel:c.func};const U="inbox";function We(){const s=Le(),r=Ee(),o=r.get("label")||U,l=r.get("id")||"",i=L("up","md"),x=Ne(),a=I(),p=I(),m=I(),{labels:h,labelsLoading:g}=De(),{mails:d,mailsLoading:y,mailsError:V,mailsEmpty:E}=$e(o),{mail:le,mailLoading:ce,mailError:W}=Be(l),N=d.allIds[0]||"",de=j.useCallback(()=>{a.value&&a.onFalse(),m.onToggle()},[m,a]),xe=j.useCallback(b=>{if(i||a.onFalse(),b){const v=b!==U?`${w.dashboard.mail}?label=${b}`:w.dashboard.mail;s.push(v)}},[a,s,i]),R=j.useCallback(b=>{i||p.onFalse();const v=o!==U?`${w.dashboard.mail}?id=${b}&label=${o}`:`${w.dashboard.mail}?id=${b}`;s.push(v)},[p,s,o,i]);j.useEffect(()=>{(V||W)&&s.push(w.dashboard.mail)},[W,V,s]),j.useEffect(()=>{!l&&N&&R(N)},[N,R,l]),j.useEffect(()=>{m.value?document.body.style.overflow="hidden":document.body.style.overflow=""},[m.value]);const he=e.jsx(Fe,{sx:{borderRadius:1.5,bgcolor:"background.default"}}),pe=e.jsx(z,{title:`Nothing in ${o}`,description:"This folder is empty",imgUrl:"/assets/icons/empty/ic_folder_empty.svg",sx:{borderRadius:1.5,maxWidth:{md:320},bgcolor:"background.default"}}),me=e.jsx(oe,{loading:g,openNav:a.value,onCloseNav:a.onFalse,labels:h,selectedLabelId:o,handleClickLabel:xe,onToggleCompose:de}),ue=e.jsx(ne,{mails:d,loading:y,openMail:p.value,onCloseMail:p.onFalse,onClickMail:R,selectedLabelId:o,selectedMailId:l}),ge=e.jsx(e.Fragment,{children:E?e.jsx(z,{imgUrl:"/assets/icons/empty/ic_email_disabled.svg",sx:{borderRadius:1.5,bgcolor:"background.default",...!i&&{display:"none"}}}):e.jsx(te,{mail:le,renderLabel:b=>h.filter(v=>v.id===b)[0]})});return e.jsxs(e.Fragment,{children:[e.jsxs(Re,{maxWidth:x.themeStretch?!1:"xl",children:[e.jsx(f,{variant:"h4",sx:{mb:{xs:3,md:5}},children:"Mail"}),e.jsxs(n,{spacing:1,sx:{p:1,borderRadius:2,overflow:"hidden",position:"relative",bgcolor:"background.neutral"},children:[!i&&e.jsx(ie,{onOpenNav:a.onTrue,onOpenMail:E?null:p.onTrue}),e.jsxs(n,{spacing:1,direction:"row",sx:{minHeight:{md:720},height:{xs:800,md:"72vh"}},children:[me,E?pe:ue,ce?he:ge]})]})]}),m.value&&e.jsx(ae,{onCloseCompose:m.onFalse})]})}function qe(){return e.jsxs(e.Fragment,{children:[e.jsx(Ue,{children:e.jsx("title",{children:" Dashboard: Mail"})}),e.jsx(We,{})]})}export{qe as default};
