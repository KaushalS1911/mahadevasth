import{u as B,r as c,f as z,j as s,W as V,cW as P,X as Q,F as Y,Z as K,N as X,g as Z,bx as $,D as R,K as v,M as F,V as M,aK as G,a as J,c as D,cX as ee,cY as se,aO as te,C as oe,q as A,cv as ae,R as ne,i as E,cZ as le,c_ as ce,c$ as re,bS as ie,d0 as de,cb as ue,h as me,bT as he,bU as ge,bV as xe,bW as pe,d1 as be,d2 as fe,d3 as ye,d4 as Ce,d5 as je,d6 as we,d7 as Re}from"./index-fhA8hu8c.js";function Se({editDialogOpen:o,setEditDialogOpen:m,editData:a,dataFiltered:y,fetchAllOrdersDemo:p,commodities:d}){const{vendor:e}=B();c.useState({});const g=z({defaultValues:{csp_code:"",commodity:"",quantity:""}}),{reset:n,handleSubmit:h,formState:{isSubmitting:b}}=g;c.useEffect(()=>{a&&n({csp_code:a==null?void 0:a.csp_code,commodity:a==null?void 0:a.commodity,quantity:a==null?void 0:a.quantity})},[a]);const C=async u=>{m(!1);const f={...u,csp_code:e.csp_code,mode:"test",status:"0"};try{const x=await v.post("http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/csp/create_order",f);x.data.status=="201"?(F("Order added successfully!"),p()):x.data.status=="400"&&F("Failed to add order.",{variant:"error"})}catch(x){console.error("Order creation error:",x),F("Order creation failed.",{variant:"error"})}};return s.jsx(V,{open:o,fullWidth:!0,maxWidth:"md",onClose:()=>m(!1),children:s.jsxs(P,{sx:{py:5,px:3},children:[s.jsx(Q,{children:"Edit Order"}),s.jsxs(Y,{methods:g,children:[s.jsxs(K,{maxWidth:"lg ",children:[s.jsx(P,{mb:2,mt:1,children:s.jsx(X,{name:"commodity",type:"commodity",label:"Commodity",placeholder:"Choose Commodity",fullWidth:!0,options:d.map(u=>u==null?void 0:u.commodity_name),getOptionLabel:u=>u})}),s.jsx(P,{mt:2,children:s.jsx(Z,{name:"quantity",label:"Quantity",fullWidth:!0})})]}),s.jsxs($,{children:[s.jsx(R,{onClick:()=>m(!1),variant:"outlined",color:"inherit",children:"Cancel"}),s.jsx(R,{variant:"contained",onClick:h(C),children:"Save"})]})]})]})})}const Pe=[{id:"srNo",label:"Sr No",width:100},{id:"commodity",label:"Commodity",width:200},{id:"quantity",label:"Quantity",width:200},{id:"quantity_approved",label:"Approved Quantity",width:200},{id:"created_at",label:"Date",width:180},{id:"status",label:"Status",width:100},{id:"",width:88}],T={name:"",commodity:[],order_status:[],status:"all"};function _e({tableData:o,fetchAllOrdersDemo:m}){const{enqueueSnackbar:a}=M(),y=G(),p=J(),d=D(),e=ee(),[g,n]=c.useState(!1),[h,b]=c.useState(0),[C,u]=c.useState([]),[f,x]=c.useState(T),[_,q]=c.useState({}),{vendor:i}=B();c.useEffect(()=>{O()},[]);const r=Fe({inputData:o,comparator:se(e.order,e.orderBy),filters:f});function O(){v.get(`http://ec2-54-173-125-80.compute-1.amazonaws.com:8080/nccf/commodity/${i==null?void 0:i.category}`).then(t=>{var l;u((l=t.data)==null?void 0:l.data)})}const j=r.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage),W=e.dense?56:76,k=!te(T,f),I=!r.length&&k||!r.length,w=c.useCallback((t,l)=>{e.onResetPage(),x(S=>({...S,[t]:l}))},[e]),U=c.useCallback(()=>{x(T)},[]),L=c.useCallback(t=>{const l=o.filter(S=>S.id!==t);a("Delete success!"),setTableData(l),e.onUpdatePageDeleteRow(j.length)},[j.length,a,e,o]),H=c.useCallback(()=>{const t=o.filter(l=>!e.selected.includes(l.id));a("Delete success!"),setTableData(t),e.onUpdatePageDeleteRows({totalRowsInPage:j.length,totalRowsFiltered:r.length})},[r.length,j.length,a,e,o]),N=c.useCallback(t=>{b(t==null?void 0:t.id),q(t)},[p]);return c.useCallback((t,l)=>{w("status",l)},[w]),c.useCallback(t=>{setTableData(l=>[...l,t])},[a]),s.jsxs(s.Fragment,{children:[s.jsxs(oe,{maxWidth:y.themeStretch?!1:"xxl",children:[(i==null?void 0:i.nccf_branch_status)!=="1"&&s.jsx(A,{sx:{mb:2,p:1.5,color:"#b71d18",backgroundColor:"#FFE4DE"},children:(i==null?void 0:i.nccf_branch_status)==""?"Account approval is pending from the Branch,You can place the orders after account approval":`Account is declined from the Branch..
You can't place the orders after account declined`}),s.jsx(ae,{heading:"Intent",links:[{name:""}],action:s.jsx(R,{disabled:(i==null?void 0:i.nccf_branch_status)!="1",component:ne,variant:"contained",startIcon:s.jsx(E,{icon:"mingcute:add-line"}),onClick:()=>{n(!0)},children:"Add Intent"}),sx:{mb:{xs:3,md:5}}}),s.jsxs(A,{children:[s.jsx(le,{filters:f,onFilters:w,commodityOptions:C,orderStatusOptions:ce}),k&&s.jsx(re,{filters:f,onFilters:w,onResetFilters:U,results:r.length,sx:{p:2.5,pt:0}}),s.jsxs(ie,{sx:{position:"relative",overflow:"unset"},children:[s.jsx(de,{dense:!0,numSelected:e.selected.length,rowCount:r.length,onSelectAllRows:t=>e.onSelectAllRows(t,r.map(l=>l.id)),action:s.jsx(ue,{title:"Delete",children:s.jsx(me,{color:"primary",onClick:d.onTrue,children:s.jsx(E,{icon:"solar:trash-bin-trash-bold"})})})}),s.jsx(he,{children:s.jsxs(ge,{size:e.dense?"small":"medium",sx:{minWidth:960},children:[s.jsx(xe,{order:e.order,orderBy:e.orderBy,headLabel:Pe,rowCount:r.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:t=>e.onSelectAllRows(t,r.map(l=>l.id))}),s.jsxs(pe,{children:[r.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage).map((t,l)=>s.jsx(be,{row:{...t,index:l},selected:e.selected.includes(t.id),onSelectRow:()=>e.onSelectRow(t.id),onDeleteRow:()=>L(t.id),onEditRow:()=>N(t)},t.id)),s.jsx(fe,{height:W,emptyRows:ye(e.page,e.rowsPerPage,o.length)}),s.jsx(Ce,{isNotFound:I})]})]})}),s.jsx(je,{count:r.length,page:e.page,rowsPerPage:e.rowsPerPage,onPageChange:e.onChangePage,onRowsPerPageChange:e.onChangeRowsPerPage,dense:e.dense,onChangeDense:e.onChangeDense})]})]})]}),s.jsx(we,{open:d.value,onClose:d.onFalse,title:"Delete",content:"Are you sure you want to delete?",action:s.jsx(R,{variant:"contained",color:"error",onClick:()=>{H(),d.onFalse()},children:"Delete"})}),s.jsx(Re,{dialogOpen:g,setDialogOpen:n,editId:_,fetchAllOrdersDemo:m,commodities:C}),s.jsx(Se,{editDialogOpen:h,setEditDialogOpen:b,editData:_,dataFiltered:r,commodities:C,fetchAllOrdersDemo:m})]})}function Fe({inputData:o,comparator:m,filters:a}){const{name:y,status:p,commodity:d,order_status:e}=a,g=o.map((n,h)=>[n,h]);return g.sort((n,h)=>{const b=m(n[0],h[0]);return b!==0?b:n[1]-h[1]}),o=g.map(n=>n[0]),y&&(o=o.filter(n=>n.commodity.toLowerCase().includes(y.toLowerCase()))),p!=="all"&&(o=o.filter(n=>n.status===p)),d.length&&(o=o.filter(n=>d.includes(n.commodity))),e.length&&(o=o.filter(n=>e.includes(n.nccf_order_status))),o}export{_e as U};
